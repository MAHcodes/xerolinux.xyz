import styled, { keyframes } from "styled-components";
import { useEffect } from "react";
import { useContext } from "react";
import { ThemeContext } from "../contexts/ThemeContext";

const ThemeIcon = ({ dark }) => {
  const { theme, setTheme } = useContext(ThemeContext);

  const toggleTheme = () => {
    setTheme(!theme);
  };

  useEffect(() => {
    document.body.classList = theme ? "light" : "dark";
    localStorage.setItem("xero-theme", JSON.stringify(theme));
  }, [theme]);

  return (
    <Div>
      {theme ? (
        <Svg
          width="30"
          height="30"
          viewBox="0 0 30 30"
          fill="none"
          onClick={toggleTheme}
          className={dark ? "dark" : ""}
        >
          <g id="moon">
            <path
              id="moon_2"
              d="M26.1975 19.1563C26.4525 18.5488 25.7237 18.0313 25.1125 18.3013C23.8907 18.8376 22.5706 19.1134 21.2362 19.1113C16.005 19.1113 11.765 14.9563 11.765 9.83001C11.7631 8.09919 12.2548 6.40372 13.1825 4.94251C13.5375 4.38251 13.1113 3.60751 12.4613 3.77251C7.45 5.05126 3.75 9.51626 3.75 14.8275C3.75 21.1363 8.96875 26.25 15.4075 26.25C20.2825 26.25 24.4575 23.3188 26.1975 19.1563Z"
              fill="#FAF4F9"
            />
            <path
              id="star"
              d="M19.5141 3.87874C18.8516 3.43624 18.0616 4.22624 18.5029 4.88874L19.2904 6.06999C19.6098 6.54894 19.7803 7.11177 19.7803 7.68749C19.7803 8.2632 19.6098 8.82603 19.2904 9.30499L18.5029 10.4862C18.0616 11.1487 18.8529 11.9387 19.5154 11.4962L20.6954 10.7087C21.1743 10.3893 21.7372 10.2188 22.3129 10.2188C22.8886 10.2188 23.4514 10.3893 23.9304 10.7087L25.1116 11.4962C25.7741 11.9387 26.5641 11.1487 26.1216 10.4862L25.3341 9.30499C25.0147 8.82603 24.8442 8.2632 24.8442 7.68749C24.8442 7.11177 25.0147 6.54894 25.3341 6.06999L26.1216 4.88874C26.5641 4.22624 25.7741 3.43624 25.1104 3.87874L23.9304 4.66624C23.4514 4.9857 22.8886 5.15618 22.3129 5.15618C21.7372 5.15618 21.1743 4.9857 20.6954 4.66624L19.5141 3.87874V3.87874Z"
              fill="#FAF4F9"
            />
          </g>
        </Svg>
      ) : (
        <Svg
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none"
          onClick={toggleTheme}
        >
          <path
            d="M16.0007 9.33331C14.2325 9.33331 12.5368 10.0357 11.2866 11.2859C10.0364 12.5362 9.33398 14.2319 9.33398 16C9.33398 17.7681 10.0364 19.4638 11.2866 20.714C12.5368 21.9643 14.2325 22.6666 16.0007 22.6666C17.7688 22.6666 19.4645 21.9643 20.7147 20.714C21.9649 19.4638 22.6673 17.7681 22.6673 16C22.6673 14.2319 21.9649 12.5362 20.7147 11.2859C19.4645 10.0357 17.7688 9.33331 16.0007 9.33331V9.33331Z"
            fill="#FAF4F9"
          />
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M16.0006 1.33331C16.3543 1.33331 16.6934 1.47379 16.9435 1.72384C17.1935 1.97389 17.334 2.31302 17.334 2.66665V3.99998C17.334 4.3536 17.1935 4.69274 16.9435 4.94279C16.6934 5.19284 16.3543 5.33331 16.0006 5.33331C15.647 5.33331 15.3079 5.19284 15.0578 4.94279C14.8078 4.69274 14.6673 4.3536 14.6673 3.99998V2.66665C14.6673 2.31302 14.8078 1.97389 15.0578 1.72384C15.3079 1.47379 15.647 1.33331 16.0006 1.33331V1.33331ZM4.39132 4.39065C4.64135 4.14068 4.98043 4.00026 5.33398 4.00026C5.68754 4.00026 6.02661 4.14068 6.27665 4.39065L8.27665 6.39065C8.51953 6.64212 8.65392 6.97892 8.65088 7.32851C8.64784 7.67811 8.50762 8.01253 8.26041 8.25974C8.0132 8.50695 7.67878 8.64717 7.32919 8.65021C6.97959 8.65325 6.64279 8.51886 6.39132 8.27598L4.39132 6.27598C4.14136 6.02594 4.00094 5.68686 4.00094 5.33331C4.00094 4.97976 4.14136 4.64068 4.39132 4.39065V4.39065ZM27.61 4.39065C27.8599 4.64068 28.0004 4.97976 28.0004 5.33331C28.0004 5.68686 27.8599 6.02594 27.61 6.27598L25.61 8.27598C25.487 8.40333 25.3399 8.5049 25.1772 8.57478C25.0145 8.64466 24.8396 8.68144 24.6625 8.68298C24.4855 8.68452 24.3099 8.65078 24.146 8.58374C23.9822 8.5167 23.8333 8.4177 23.7081 8.29251C23.5829 8.16732 23.4839 8.01845 23.4169 7.85458C23.3498 7.69072 23.3161 7.51515 23.3176 7.33811C23.3192 7.16107 23.356 6.98611 23.4258 6.82344C23.4957 6.66077 23.5973 6.51364 23.7246 6.39065L25.7246 4.39065C25.9747 4.14068 26.3138 4.00026 26.6673 4.00026C27.0209 4.00026 27.3599 4.14068 27.61 4.39065ZM1.33398 16C1.33398 15.6464 1.47446 15.3072 1.72451 15.0572C1.97456 14.8071 2.3137 14.6666 2.66732 14.6666H4.00065C4.35427 14.6666 4.69341 14.8071 4.94346 15.0572C5.19351 15.3072 5.33398 15.6464 5.33398 16C5.33398 16.3536 5.19351 16.6927 4.94346 16.9428C4.69341 17.1928 4.35427 17.3333 4.00065 17.3333H2.66732C2.3137 17.3333 1.97456 17.1928 1.72451 16.9428C1.47446 16.6927 1.33398 16.3536 1.33398 16ZM26.6673 16C26.6673 15.6464 26.8078 15.3072 27.0578 15.0572C27.3079 14.8071 27.647 14.6666 28.0006 14.6666H29.334C29.6876 14.6666 30.0267 14.8071 30.2768 15.0572C30.5268 15.3072 30.6673 15.6464 30.6673 16C30.6673 16.3536 30.5268 16.6927 30.2768 16.9428C30.0267 17.1928 29.6876 17.3333 29.334 17.3333H28.0006C27.647 17.3333 27.3079 17.1928 27.0578 16.9428C26.8078 16.6927 26.6673 16.3536 26.6673 16ZM8.27665 23.724C8.52661 23.974 8.66703 24.3131 8.66703 24.6666C8.66703 25.0202 8.52661 25.3593 8.27665 25.6093L6.27665 27.6093C6.02518 27.8522 5.68838 27.9866 5.33878 27.9835C4.98919 27.9805 4.65477 27.8403 4.40756 27.5931C4.16035 27.3459 4.02012 27.0114 4.01709 26.6618C4.01405 26.3122 4.14844 25.9754 4.39132 25.724L6.39132 23.724C6.64135 23.474 6.98043 23.3336 7.33398 23.3336C7.68754 23.3336 8.02661 23.474 8.27665 23.724V23.724ZM23.7246 23.724C23.9747 23.474 24.3138 23.3336 24.6673 23.3336C25.0209 23.3336 25.3599 23.474 25.61 23.724L27.61 25.724C27.8529 25.9754 27.9873 26.3122 27.9842 26.6618C27.9812 27.0114 27.8409 27.3459 27.5937 27.5931C27.3465 27.8403 27.0121 27.9805 26.6625 27.9835C26.3129 27.9866 25.9761 27.8522 25.7246 27.6093L23.7246 25.6093C23.4747 25.3593 23.3343 25.0202 23.3343 24.6666C23.3343 24.3131 23.4747 23.974 23.7246 23.724ZM16.0006 26.6666C16.3543 26.6666 16.6934 26.8071 16.9435 27.0572C17.1935 27.3072 17.334 27.6464 17.334 28V29.3333C17.334 29.6869 17.1935 30.0261 16.9435 30.2761C16.6934 30.5262 16.3543 30.6666 16.0006 30.6666C15.647 30.6666 15.3079 30.5262 15.0578 30.2761C14.8078 30.0261 14.6673 29.6869 14.6673 29.3333V28C14.6673 27.6464 14.8078 27.3072 15.0578 27.0572C15.3079 26.8071 15.647 26.6666 16.0006 26.6666V26.6666Z"
            fill="#FAF4F9"
          />
        </Svg>
      )}
    </Div>
  );
};

const Div = styled.div`
  display: flex;
  align-items: center;
`;

const fadeIn = keyframes`
  from {
    opacity: 0;
    transform: scale(.5) rotate(90deg);
  }
`;

const Svg = styled.svg`
  width: var(--icon-size);
  height: var(--icon-size);
  cursor: pointer;
  animation: ${fadeIn} 0.75s var(--transition-timing-function);
  &.dark path {
    fill: rgb(var(--low)) !important;
  }
`;

export default ThemeIcon;
